---
title: '데드락 (Deadlock, 교착 상태)'
type: 'concept'
language: 'OS'
tags:
  - Deadlock
dateModified: 2025.09.06
---

import { ImageContainer } from '/src/components/ui/ImageContainer.tsx';

# 데드락 (Deadlock, 교착 상태)이란?

데드락이란 두 개 이상의 프로세스나 스레드가 서로 상대방이 가진 자원을 기다리면서 아무도 진행하지 못하는 상태를 말합니다.

#### 예시

<ImageContainer category="os" fileName="deadlock.png" alt="deadlock 예시" />

- **트랜잭션 A**
  - `Accounts` 테이블의 일부 행에 **락 보유**
  - `Orders` 테이블의 행들을 업데이트해야 작업 완료 가능

- **트랜잭션 B**
  - `Orders` 테이블의 일부 행에 **락 보유**
  - `Accounts` 테이블의 행들을 업데이트해야 작업 완료 가능

이 상황에서 두 트랜잭션은 서로 상대방의 락을 기다리게 되고, DBMS가 이를 감지하여 트랜잭션 중 하나를 강제로 종료하지 않는 한 교착 상태가 계속 유지됩니다.

## 데드락 발생 조건 (필수 4가지)

교착 상태는 다음 조건이 **모두 만족**될 때 발생합니다.

1. **상호 배제 (Mutual Exclusion)**  
   한 번에 한 프로세스만 자원을 사용할 수 있습니다.
2. **점유 대기 (Hold and Wait)**  
   하나 이상의 자원을 점유한 상태에서, 다른 프로세스에 할당된 자원을 추가로 요청하며 대기하는 프로세스가 존재해야 합니다.
3. **비선점 (No Preemption)**  
   프로세스에 할당된 자원은 사용이 끝날 때까지 강제로 빼앗을 수 없습니다.
4. **순환 대기 (Circular Wait)**  
   프로세스 집합 내에서 순환 형태로 자원을 기다리고 있어야 합니다.

## 데드락 해결 방법

### 1. 예방 (Prevention)

교착 상태 발생 조건 중 하나라도 성립하지 않도록 합니다.

- **상호 배제 부정**: 여러 프로세스가 동시에 자원을 공유할 수 있도록 허용합니다.
- **점유 대기 부정**: 프로세스 실행 전에 필요한 모든 자원을 할당하거나, 프로세스가 자원을 점유하지 않은 상태에서만 요청할 수 있도록 합니다.
- **비선점 부정**: 우선순위가 높은 프로세스가 자원을 선점할 수 있도록 합니다.
- **순환 대기 부정**: 자원에 고유 번호를 부여하고, 각 프로세스는 점유한 자원의 번호보다 높은 번호(또는 낮은 번호) 순서로만 자원을 요구하도록 합니다.

### 2. 회피 (Avoidance)

안정 상태(Safe state)에서만 자원을 할당합니다.

- **안정 상태 (Safe State)**  
  → 자원을 할당해도 교착 상태가 발생하지 않는 경우
- **불안정 상태 (Unsafe State)**  
  → 교착 상태 발생 가능성이 있는 경우

**은행원 알고리즘 (Banker's Algorithm)**

은행원 알고리즘은 교착 상태를 피하기 위한 대표적인 회피 알고리즘입니다. <br />
은행원이 고객의 모든 대출 요청을 안전하게 처리할 수 있는지 확인하는 것처럼, 시스템도 프로세스의 자원 할당 요청이 안전하게 수행될 수 있는지 미리 판단합니다.

프로세스가 자원을 요청하면, 시스템은 자원을 할당한 후에도 안정 상태(Safe State)가 유지되는지 검사합니다.

- 안정 상태라면 자원을 할당하고,
- 불안정 상태라면 다른 프로세스가 자원을 반환할 때까지 요청을 대기시킵니다.

### 3. 탐지 (Detection)

**자원 할당 그래프 (Resource Allocation Graph, RAG) 사용**

자원 할당 그래프는 프로세스가 어떤 자원을 할당받았고, 어떤 자원을 요청하고 있는지 시각적으로 보여줍니다.

- 프로세스와 자원을 노드 (Node)로, 프로세스가 자원을 요청하거나 자원이 프로세스에 할당되는 관계를 엣지 (Edge)로 표현합니다.
- 사이클 존재 여부로 교착 상태를 판별합니다.
  - 자원 유형 당 인스턴스가 하나만 있는 경우 교착 상태가 발생합니다.
  - 자원 유형 당 여러 인스턴스가 있는 경우 **교착 상태가 발생할 가능성**이 있습니다.

<ImageContainer category="os" fileName="rag1.png" alt="교착 상태가 있는 RAG" />

<ImageContainer category="os" fileName="rag2.png" alt="사이클은 있지만 교착 상태는 없는 RAG" />

### 4. 회복 (Recovery)

교착 상태에 빠진 시스템을 정상 상태로 되돌리는 방법으로, 주로 두 가지 접근 방식이 있습니다.

- **프로세스 종료**
  - 교착 상태에 있는 프로세스를 모두 중지하거나, 교착 상태가 해소될 때까지 하나씩 종료합니다.
- **자원 선점**
  - 교착 상태에 있는 프로세스가 점유한 자원을 선점하여 다른 프로세스에 할당합니다.
