---
title: '트랜잭션(Transaction)'
type: 'concept'
language: 'SQL'
tags:
  - Database
  - Transaction
dateModified: 2025.09.21
---

# 트랜잭션(Transaction)이란?

트랜잭션은 데이터베이스의 논리적 작업 단위입니다.  
데이터베이스의 상태를 바꾸기 위해 실행되는 일련의 연산들을 의미하며, 하나의 작업이 성공적으로 수행되면 데이터베이스는 영구적으로 변경됩니다. 반대로 실패하면 모든 변경 사항은 취소됩니다.

---

## 작업 단위란?

DB에서 작업 단위(Unit of Work)는 하나의 논리적인 작업을 수행하는 최소 단위입니다. 즉, 여러 개의 SQL 명령문을 하나로 묶어 "이 작업은 반드시 함께 처리되어야 한다"라는 조건을 만족하는 연산 집합을 의미합니다.

### 예제 1: 은행 계좌 이체
- A 계좌에서 50,000원 출금  
- B 계좌에 50,000원 입금  

위 두 작업은 반드시 함께 실행되어야 합니다. 만약 중간에 오류가 발생해 A 계좌에서만 출금되고 B 계좌에 입금되지 않았다면 전체 작업은 취소(ROLLBACK)되어야 합니다.

### 예제 2: 쇼핑몰 주문 처리
- 상품 재고 감소  
- 주문 내역 저장  
- 결제 내역 저장  

세 가지 작업이 모두 성공해야만 주문이 정상적으로 완료됩니다. 하나라도 실패하면 전체를 취소(ROLLBACK)하여 처음 상태로 되돌립니다.

## 트랜잭션과의 관계

작업 단위는 트랜잭션이 보장하는 논리적인 작업 덩어리입니다. 트랜잭션은 작업 단위를 묶어서 한 번에 처리하거나 오류 발생 시 전부 취소합니다.  
따라서 트랜잭션은 **작업 단위의 온전한 실행을 보장**하는 역할을 합니다.

# 트랜잭션의 특성 (ACID)

트랜잭션이 올바르게 수행되기 위해서는 **ACID 원칙**을 준수해야 합니다.

## 1. Atomicity (원자성)

트랜잭션의 연산은 모두 수행되거나, 하나도 수행되지 않아야 합니다. 예를 들어 A 계좌에서 돈이 빠져나갔는데 B 계좌에 입금되지 않는 상황은 허용되지 않습니다.

원자성은 롤백(ROLLBACK)과 세이브포인트(SAVEPOINT)를 통해 보장됩니다.

```sql
commit;

update dept set dname = 'QC2' where deptno=70;
savepoint SP1;

delete from dept where deptno = 70;
savepoint SP2;

insert into dept values (50, '부서명', '지역명');

rollback; -- 마지막 commit 시점으로 전체 취소
rollback to savepoint SP1; -- SP1 이후 작업만 취소
```

## 2. Consistency (일관성)

트랜잭션 전후로 데이터베이스의 무결성이 유지되어야 합니다.
예를 들어 은행 계좌의 전체 잔액 합계는 변하지 않아야 합니다.

일관성은 주로 트리거(Trigger) 등을 통해 자동으로 보장합니다.

## 3. Isolation (고립성)

여러 트랜잭션이 동시에 실행되더라도 서로의 작업에 영향을 주어서는 안 됩니다.
한 트랜잭션의 결과는 해당 트랜잭션이 완료될 때까지 다른 트랜잭션에서 참조할 수 없습니다.

## 4. Durability (지속성)

트랜잭션이 완료되면 시스템 장애가 발생하더라도 결과는 유지되어야 합니다.
이를 위해 Write Ahead Logging(WAL) 같은 기술이 사용됩니다.

# 추가 단어 개념 정리
- rollback : 실행된 트랜잭션을 취소하고 이전 상태로 되돌리는 것을 의미합니다.
- savepoint : 트랜잭션 중간에 되돌아갈 지점을 지정하는 것을 의미합니다. ROLLBACK TO 명령으로 해당 시점 이후 작업만 취소가 가능합니다.
- trigger : 특정 이벤트(insert, update, delete 등)가 발생했을 때 자동으로 실행되는 SQL 코드입니다. 일관성 유지에 활용됩니다.
- WAL (Write Ahead Logging) : 변경 사항을 실제 DB에 적용하기 전에 로그에 먼저 기록하는 방식을 의미합니다. 장애가 발생해도 로그를 이용해 데이터를 복구할 수 있습니다.